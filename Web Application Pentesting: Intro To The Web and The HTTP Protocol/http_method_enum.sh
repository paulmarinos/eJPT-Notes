#!/bin/bash

# poc for the ejpt-notes repo.
# simple script that will allow us to recognize which methods are allowed or not from a webserver.

# we first create an array of http methods to check. HEAD is not in here, as its not a method you
# can allow or not, it's just there.
methods=("GET" "POST" "PUT" "DELETE" "CONNECT" "OPTIONS" "TRACE")

# now we create a variable that will store our webpage to test
webpage="http://google.com"

# this statement will loop on the entire method array. i've used this in scanning scripts before and
# it comes very handy when you don't know that Nmap has an -iL option lol. painful.
for i in ${methods[@]}; do
	# this line of commands evaluate the stderr of the initial curl command. && and || work as
	# flow "managers".
	curl -X "$i" -s $webpage | grep "405" && echo "$i method not allowed" || echo "$i method allowed"
	# curl requests the $i method, grep searches for the not allowed status code, if it finds anything, that is,
	# if stederr is 0, the method is not allowed. if the stederr is other than 0, the || comes into play and
	# the method is indeed allowed.
done
