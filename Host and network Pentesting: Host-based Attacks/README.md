# Table of contents (WiP)

- [Intro to attacks](#1)
- [Windows](#2)
  - [Windows vulnerabilities](#2.1)
    - [Types of vulnerabilities](#2.1.1)
  - [Frequently exploited Windows vulnerabilities](#2.2)
  - [Exploiting Windows vulnerabilities](#2.3)
    - [Exploiting Microsoft IIS WebDAV](#2.3.1)
      - [What is Microsoft IIS?](#2.3.1.1)
  - [Windows Privilege Escalation](#2.4)
  - [Windows File System vulnerabilities](#2.5)
  - [Windows Credential Dumping](#2.6)

# More to come.

<a id=1></a>
# Intro to attacks

System-based or host-based attacks are attacks that target specific system or host running a specific operating
system such as Linux or Windows.

We need to understand that network services are not the only ones that we can target. There is a world of services out there.
Some more secure than others. Some easier to exploit, some harder.

This kinds of attacks usually come in to play after you've gained access to a target network, where you'll need to exploit
servers, laptops or endpoints on the internal network.

This kinds of attacks focus on exploiting the inherent flaws of an operating system.

Unlike network attacks, host based attacks are more specialized and require an understanding of the underlying OS in place and
the vulnerabilities that plague those OS's.

<a id=2></a>
# Windows

<a id=2.1></a>
## Windows vulnerabilities

Windows is a largely used OS. For that, it has had it large amount of exploits released and vulnerabilities
discovered and exploited. MS08-067 (Conflicker), MS17-010 (EternalBlue) are examples of this.

Given the updates and new versions of Windows being released, many users do not upgrade to the latest and greatest.
Many times this makes them vulnerable to many kinds of attacks. For example: if a vulnerability is found in Windows 7
nowadays, it probably won't be fixed, since that version has reached EOL (End of Life).

Windows by itself when installed is insecure by default. It is not configured to run proactively and securely. It gives
user control over the security controls that might or might not be implemented into their systems, but this is dangerous.
What was the last time you saw or heard a Windows user talking about configuring their firewall? Changing their login password
every X months? ;)

<a id=2.1.1></a>
### Types of vulnerabilities

- Information disclosure: allows an attacker to access confidential information.
- Buffer overflows: allows attacker to write data to a buffer and overrun the allocated one, consequently
  writing data to allocated memory addresses.
- Remote code execution: allows attackers to remotely execute arbitrary code and commands.
- Privilege escalation: vulnerability that allows attackers to elevate their privileges.
- Denial of Service: allows attackers to waste machine resources to prevent normal functionality of a server 
  or services.

<a id=2.2></a>
## Frequently Exploited Windows Services

Windows has various native services and protocols that can be configured to run 
on a host. These services provide an attacker with an attack vector. These 
can be used to gain access to a target host.

| Protocol           | Ports           | Purpose                                                                                                    |
|------------------- | --------------- | ---------------------------------------------------------------------------------------------------------- |
| Microsoft IIS      | TCP 80/443      | Web server.                                                                                                |
| WebDAV             | TCP 80/443      | HTTP extension that allows clients to update, delete, move and copy files on a web server. Similar to GIT. |
| SMB/CIFS           | TCP 445         | Network file sharing protocol. Used to facilitate the task of sharing files.                               |
| RDP                | TCP 3389        | Remote access protocol. Used to remotely interact with a device.                                           |
| WinRM              | TCP 5986/443    | Remote management protocol used to facilitate access to Windows systems.                                   |

<a id=2.3></a>
## Exploiting Windows vulnerabilities

<a id=2.3.1></a>
### Exploiting Microsoft IIS WebDAV

<a id=2.3.1.1></a>
#### What is Microsoft IIS?

It is a proprietary extensible web server developed by Microsoft for the Windows NT kernel.

It can be used to host web applications as well as webpages and provides administrators with
a robust GUI for managing websites.

It can host both static and dynamic websites written in ASP.NET and PHP.

Tipically runs on port 80 and 443 (SSL). It supports the following file extensions:

- .asp 
- .aspx
- .config
- .php

<a id=2.3.1.2></a>
#### But what is a WebDAV?

WebDAV (Web-based Distributed Authoring and Versioning) is a set of HTTP extensions that allow users
to collaboratively edit and manage files on remote web servers.

It essentially enables a git extension on the HTTP protocol. And as so, it also runs usually on ports 80 and 
443. 

To connect to WebDAV, you have to pass valid credentials. This is because it implements authentication in the form
of user and password.

#### Exploitation

The first steps to exploit WebDAV is to check for the following:

- Is it running on an IIS server?
- Try bruteforcing credentials.
- Authenticate and upload a malicious ASP payload to execute 
  arbitrary commands.

Some tools we can use are:

- davtest: Scan, authenticate and exploit a WebDAV server.
- cadaver: Upload and download files, on-screen display, editing,
  namespace operations, collection creation and deletion, property
  manipulation and more. It's a CLI client.

```bash
$ nmap -sV [TARGET] # Identify the IIS server.
# A useful script is http-webdav-scan. If an IIS server is found, it'll be used automatically.
$ nmap -sV [TARGET] -p80/443 --script=http-enum 
# Just enumerate the target. You can use ffuf, gobuster, etc.
$ hydra -L /path/to/users -P /path/to/passwords [TARGET] http-get /webdav-directory
$ davtest -auth user:password -url [TARGET/webdav-endpoint] 
$ cadaver http://[IP]/webdav-endpoint
Username: user
Password: pass
# Now we should have a pseudoterminal.

```


<a id=2.4></a>
## Windows Privilege Escalation
<a id=2.5></a>
## Windows File System vulnerabilities
<a id=2.6></a>
## Windows Credential Dumping
